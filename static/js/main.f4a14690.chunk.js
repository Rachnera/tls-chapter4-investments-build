(this["webpackJsonptls-chapter4-investments"]=this["webpackJsonptls-chapter4-investments"]||[]).push([[0],{147:function(e,t,n){var r=n(240),i=["prepare","preprocess","process","clean"];e.exports=function(){var e=new Worker(n.p+"102891712d96f2e83112.worker.js",{name:"[hash].worker.js"});return r(e,i),e}},163:function(e,t,n){},164:function(e,t,n){},242:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),a=n(26),s=n.n(a),c=(n(163),n(35)),o=n(87),l=n.n(o),u=n(105),d=(n(164),n(47)),h=n(97),j=n(153),b=n(248),m=n(246),v=n(249),p=n(95),f=n(96),g=n(119),O=n(44),x=n(6),S=["Min's Trade Route","Yhilini Succubi Trade","Yhilini Bank Core Lender","Mercenary Offices","Theltiar Rentals","Theltiar Flowhouse","Denmiel Mushrooms","Denmiel Archives","Eustrin Guild","Gasm Falls Trade","Premium Steel Owner"],y={previous:["Premium Steel Owner","Min's Trade Route","Yhilini Succubi Trade","Eustrin Guild"],remainingPron:5e3,baseProfit:2e6,chapter1Bank:!0,chapter1Steel:!1,strategy:"social",startingSocial:34,chapter3Infrastructure:!0,merchantSolution:"neutral",jhenno:"religion",magicalItems:"givini"},w=function(e){var t=e.strategy,n=e.jhenno;return"money"!==t&&"politics"!==n},I={required:!0,message:"Please provide a value."},k=function(e){var t,n=e.onFinish,i=e.loading,a=Object(r.useState)(y.previous),s=Object(c.a)(a,2),o=s[0],l=s[1],u=b.a.useForm(),d=Object(c.a)(u,1)[0],h=Object(r.useState)(w(y)),k=Object(c.a)(h,2),C=k[0],P=k[1];return Object(r.useEffect)((function(){C||"neutral"!==d.getFieldValue("merchantSolution")||d.setFieldsValue({merchantSolution:"wait"})}),[d,C]),Object(x.jsx)(m.a,{title:"Round one",children:Object(x.jsxs)(b.a,{initialValues:y,onFinish:n,onValuesChange:function(e,t){l(t.previous),P(w(t))},className:"first-round-form",form:d,children:[Object(x.jsxs)(m.a,{title:"The past",type:"inner",children:[Object(x.jsxs)("div",{className:"numbers",children:[Object(x.jsx)(b.a.Item,{label:"ProN remaining at the end of chapter 3",name:"remainingPron",tooltip:'In the Calculator, go to "War Investment Phase" and copy the value next to "ProN available".',rules:[I],children:Object(x.jsx)(v.a,{})}),Object(x.jsx)(b.a.Item,{label:"Total profit at the start of chapter 4",name:"baseProfit",tooltip:'In the Calculator, go to "First Tower Run and Investment and copy the value next to "Total ProN Return".',rules:[I],children:Object(x.jsx)(v.a,{})}),Object(x.jsx)(b.a.Item,{label:"Your social standing at the start of chapter 4",name:"startingSocial",tooltip:'In the Calculator, go to "War Investment Phase" and copy the value next to "Social Score".',rules:[I],children:Object(x.jsx)(v.a,{})})]}),Object(x.jsx)(b.a.Item,{label:"Investments already bought during chapters 2/3",name:"previous",children:Object(x.jsx)(p.a,{options:(t=S,Object(j.a)(t).sort().map((function(e){return{label:e,value:e}}))),mode:"multiple"})}),Object(x.jsxs)("div",{className:"checkboxes",children:[!o.includes("Yhilini Bank Core Lender")&&Object(x.jsx)(b.a.Item,{name:"chapter1Bank",valuePropName:"checked",children:Object(x.jsx)(f.a,{children:"You invested 25,000 ProN in the Yhilin Bank during chapter 1."})}),!o.includes("Premium Steel Owner")&&Object(x.jsx)(b.a.Item,{name:"chapter1Steel",valuePropName:"checked",children:Object(x.jsx)(f.a,{children:"You invested 20,000 ProN in Premium Steel during chapter 1."})}),!(o.includes("Yhilini Succubi Trade")&&o.includes("Mercenary Offices"))&&Object(x.jsx)(b.a.Item,{name:"chapter3Infrastructure",valuePropName:"checked",children:Object(x.jsx)(f.a,{children:"You funded Yhilin Infrastructure during chapter 3."})})]})]}),Object(x.jsxs)(m.a,{title:"Strategy",type:"inner",children:[Object(x.jsx)(b.a.Item,{name:"strategy",label:"Main strategy",rules:[I],children:Object(x.jsx)(g.a.Group,{options:[{label:"Focus on profits; do only the bare minimum for the Ardan succession crisis (New Givini \u2265 25).",value:"money"},{label:"Mix profits and social; reach most thresholds for the Ardan succession crisis (New Givini \u2265 25, Social \u2265 40).",value:"social"},{label:"Go all in on the Ardan succession crisis (New Givini \u2265 25, Social \u2265 40, dedicated investments).",value:"succession"}]})}),Object(x.jsxs)("div",{className:"selects",children:[Object(x.jsx)(b.a.Item,{label:"Jhenno's cooperation",name:"jhenno",children:Object(x.jsx)(p.a,{options:[{value:"politics",label:"Politics"},{value:"religion",label:"Religion"}]})}),Object(x.jsx)(b.a.Item,{label:"Rose's house magical items",name:"magicalItems",children:Object(x.jsx)(p.a,{options:[{value:"givini",label:"Givini"},{value:"takkan",label:"Tak'Kan"}]})}),Object(x.jsx)(b.a.Item,{label:"Merchant dispute",name:"merchantSolution",children:Object(x.jsx)(p.a,{options:[{value:"neutral",label:"Neutral compromise"+(C?"":" (unavailable with this strategy)"),disabled:!C},{value:"givini",label:"Favor New Givini"},{value:"wait",label:"Wait"}]})})]})]}),Object(x.jsx)(b.a.Item,{children:Object(x.jsx)(O.a,{type:"primary",htmlType:"submit",loading:i,children:"Submit"})})]})})},C=n(245),P=function(e){return e.toLocaleString("en-US")},T=120,N=function(e){var t=e.children,n=e.format?P(Math.abs(t)):Math.abs(t);return"".concat(t<0?"-":"+").concat(n)},G=function(e){var t=e.investments.map((function(e){var t=e.name,n=Object(h.a)(e,["name"]);return Object(d.a)({key:t,name:t},n)})),n=[{title:"Name",dataIndex:"name",sorter:function(e,t){return e.name.localeCompare(t.name)}},{title:"Price",dataIndex:"price",render:function(e){return P(e)},sorter:function(e,t){return e.price-t.price},width:T},{title:"Profits",dataIndex:"profits",render:function(e){return P(e)},sorter:function(e,t){return e.profits-t.profits},width:T},{title:"Social",dataIndex:"social",render:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return Object(x.jsx)(N,{children:e})},width:T}];return Object(x.jsx)(C.a,{dataSource:t,columns:n,pagination:!1})},M=function(e){var t=e.list,n=(void 0===t?[]:t).map((function(e){var t=e.name,n=Object(h.a)(e,["name"]);return Object(d.a)({key:t,name:t},n)})),r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return Object(x.jsx)(N,{format:!0,children:e})},i=[{title:"Name",dataIndex:"name"},{title:"Price",dataIndex:"price",render:r,width:T},{title:"Profits",dataIndex:"profits",render:r,width:T},{title:"Social",dataIndex:"social",render:r,width:T}];return Object(x.jsx)(C.a,{dataSource:n,columns:i,pagination:!1})},F=function(e){var t=e.initialStandings,n=e.nonInvestmentChanges,r=e.investmentChanges,i=function(e,t){var n=t.key;return["base","total"].includes(n)?P(e):Object(x.jsx)(N,{format:!0,children:e})},a=[{dataIndex:"category"},{title:"ProN",dataIndex:"money",render:i,width:T},{title:"Profits",dataIndex:"profits",render:i,width:T},{title:"Social",dataIndex:"social",render:i,width:T}],s=function(e){return t[e]+n[e]+r[e]},c=[Object(d.a)(Object(d.a)({},t),{},{key:"base",category:"Previously"}),Object(d.a)(Object(d.a)({},r),{},{key:"investments",category:"Changes from investments",money:-r.price}),Object(d.a)(Object(d.a)({},n),{},{key:"other",category:"Other changes"})];return Object(x.jsx)(C.a,{dataSource:c,columns:a,pagination:!1,bordered:!0,expandable:{expandedRowRender:function(e){var t=e.key;return"investments"===t?Object(x.jsx)(G,{investments:r.investments}):"other"===t?Object(x.jsx)(M,{list:n.list}):null},rowExpandable:function(e){var t=e.key;return["investments","other"].includes(t)},defaultExpandAllRows:!0},summary:function(){return Object(x.jsxs)(C.a.Summary.Row,{children:[Object(x.jsx)(C.a.Summary.Cell,{colSpan:2,children:"Result"}),Object(x.jsx)(C.a.Summary.Cell,{children:P(t.money+n.money-r.price)}),Object(x.jsx)(C.a.Summary.Cell,{children:P(s("profits"))}),Object(x.jsx)(C.a.Summary.Cell,{children:s("social")})]})}})},R=function(e){var t=e.startingValue,n=void 0===t?0:t,r=e.dataSources;return Object(x.jsxs)("table",{className:"addition",children:[Object(x.jsx)("tbody",{children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("td",{children:"Initial value"}),Object(x.jsx)("td",{children:n}),Object(x.jsx)("td",{})]})}),r.map((function(e,t){var n=e.title,r=e.dataSource;return Object(x.jsxs)("tbody",{children:[Object(x.jsx)("tr",{children:Object(x.jsx)("th",{colSpan:"3",scope:"col",children:n})}),r.map((function(e,t){var n=e.label,r=e.values,i=e.explanation;return Object(x.jsxs)("tr",{children:[Object(x.jsx)("td",{children:n}),Object(x.jsx)("td",{children:r.map((function(e){return"+".concat(e)})).join(" ")}),Object(x.jsx)("td",{children:i})]},t.toString())}))]},t.toString())})),Object(x.jsx)("tfoot",{children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("th",{scope:"row",children:"Total"}),Object(x.jsx)("td",{children:n+r.reduce((function(e,t){return e+t.dataSource.reduce((function(e,t){return e+t.values.reduce((function(e,t){return e+t}))}),0)}),0)})]})})]})},E=function(e){return e.reduce((function(e,t){return e+t.values.reduce((function(e,t){return e+t}),0)}),0)},Y=function(e){return[{label:"Petitions",values:[5,5,2,2,2]},{label:"New Givini Trade",values:[5,1],explanation:"+5 when bought, +1 at round's start"},e.investments.includes("Min's Trade Route")&&{label:"Min's Trade Route",values:[1]}].filter(Boolean)},L=function(e){var t=e.chapter3Investments;return-5+E(Y({investments:t}))},A=function(e){var t=e.merchantSolution;return["givini"===e.magicalItems&&{label:"House Rose's magical items: Givini",values:[2]},"neutral"===t&&{label:"Merchant dispute: Neutral compromise",values:[1]},"givini"===t&&{label:"Merchant dispute: Favor New Givini",values:[2]},{label:"Givino Vinai equipment shop girl",values:[1]},{label:"Givini king",values:[1]},{label:"New Givini Trade",values:[1],explanation:"+1 at the end of the round (before profits from the Givini Orc Merchant are computed)"}].filter(Boolean)},B=function(){return E(A.apply(void 0,arguments))},W=function(e){var t=e.chapter3Investments,n=void 0===t?[]:t,r=e.roundOneInvestments,i=void 0===r?[]:r,a=e.decisions,s=void 0===a?{}:a;return Object(x.jsx)(R,{startingValue:-5,dataSources:[{title:"Chapter start",dataSource:Y({investments:n})},{title:"Investments",dataSource:i.filter((function(e){var t=e.givini;return 0!==(void 0===t?0:t)})).map((function(e){return{label:e.name,values:[e.givini]}})).sort((function(e,t){var n=e.label,r=t.label;return n.localeCompare(r)}))},{title:"Other changes",dataSource:A(s)}]})},q=function(e){var t=e.initialStandings,n=e.nonInvestmentChanges,r=e.investmentChanges,i=e.decisions;return Object(x.jsxs)(m.a,{title:"Changes",className:"results",children:[Object(x.jsx)(m.a,{title:"Ledger",type:"inner",className:"ledger",children:Object(x.jsx)(F,{initialStandings:t,nonInvestmentChanges:n,investmentChanges:r})}),Object(x.jsx)(m.a,{title:"Countries",type:"inner",children:Object(x.jsx)(m.a,{title:"New Givini",type:"inner",children:Object(x.jsx)(W,{chapter3Investments:t.previousInvestments,roundOneInvestments:r.investments,decisions:i})})})]})},V=n(252),J=function(e){var t=e.message;return Object(x.jsx)(m.a,{children:Object(x.jsx)(V.a,{status:"warning",title:t})})},D=function(e){var t=e.strategy,n=e.startingSocial,r=e.jhenno;return"money"===t?0:"politics"===r?39-n:40-n},K=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,r,i,a,s,c,o,u,j,b,m,v,p,f,g,O,x,S,y,w,I,k;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.values,r=t.setResult,i=t.runInWoker,(a=t.setError)(void 0),s=n.previous,c=void 0===s?[]:s,o=n.remainingPron,u=n.baseProfit,j=n.strategy,b=n.startingSocial,m=n.merchantSolution,v=n.jhenno,p=n.magicalItems,f=Object(h.a)(n,["previous","remainingPron","baseProfit","strategy","startingSocial","merchantSolution","jhenno","magicalItems"]),g={strategy:j,merchantSolution:m,magicalItems:p},O=L({chapter3Investments:c}),x=B(g),S={givini:O,social:b,money:o+u,profits:u,previousInvestments:c},y=["politics"===v&&{name:"Jhenno's political cooperation",social:1},{name:"Succession crisis' reward (best result)",social:3},{name:"The Three Trades become less profitable",profits:-3e5}].filter(Boolean),w={givini:x,money:0,profits:y.reduce((function(e,t){var n=t.profits;return e+(void 0===n?0:n)}),0),social:y.reduce((function(e,t){var n=t.social;return e+(void 0===n?0:n)}),0),list:y},I=Object(d.a)({previousInvestments:c,money:o+u,otherRequirements:{social:D({startingSocial:b,strategy:j,jhenno:v}),givini:(l={giviniStart:O,giviniExtra:x},25-l.giviniStart-l.giviniExtra+3),donovanKick:"succession"===j},giviniStart:O,giviniExtra:x},f),e.next=12,i(I);case 12:if(k=e.sent){e.next=17;break}return r(void 0),a("Couldn't find a working combination of investments for that strategy with these starting values, sorry."),e.abrupt("return");case 17:r({initialStandings:S,nonInvestmentChanges:w,investmentChanges:k,decisions:g});case 18:case"end":return e.stop()}var l}),e)})));return function(t){return e.apply(this,arguments)}}(),U=function(e){var t=e.runInWoker,n=e.loading,i=Object(r.useState)(),a=Object(c.a)(i,2),s=a[0],o=a[1],l=Object(r.useState)(),u=Object(c.a)(l,2),h=u[0],j=u[1];return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(k,{onFinish:function(e){K({values:e,setResult:o,runInWoker:t,setError:j})},loading:n}),h&&Object(x.jsx)(J,{message:h}),s&&Object(x.jsx)(q,Object(d.a)({},s))]})},z=n(147),H=n.n(z),_=n(247),Q=n(253),X=_.a.Title,Z=function(){return Object(x.jsxs)("div",{className:"disclaimer",children:[Object(x.jsxs)("div",{className:"preamble",children:[Object(x.jsx)(X,{children:"Investment advisor"}),Object(x.jsxs)("p",{children:["A tool to help you choose the best theoretical best possible investments for (the early steps of chapter 4 of) ",Object(x.jsx)("a",{href:"https://the-last-sovereign.blogspot.com/",children:"The Last Sovereign"}),"."]}),Object(x.jsx)("p",{children:"Just fill in the requested information, choose your strategy and let a quasi-brute force algorithm determine what's best for you (assuming a definition of best here as highest short term returns, then the lowest price, while still fulfilling the requirements of your strategy)."}),Object(x.jsxs)("p",{children:["This is definetely an advanced tool, intended for people who are already familiar with the game's ",Object(x.jsx)("a",{href:"https://thelastsovereign.miraheze.org/wiki/Secret_stats",children:"inner workings"}),", with the awesome ",Object(x.jsx)("a",{href:"https://thelastsovereign.flarum.cloud/d/15-calculator",children:"Calculator"}),", and are now looking for the last lousy optimizations they might have missed."]})]}),Object(x.jsx)(Q.a,{message:"Assumptions",description:Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("span",{children:"This tool takes for granted that:"}),Object(x.jsxs)("ol",{children:[Object(x.jsx)("li",{children:"The Succubus Tower was visited during chapter 1."}),Object(x.jsx)("li",{children:"AriGarda was bribed during chapter 2."}),Object(x.jsx)("li",{children:"Tradesmasher and the Succubus Armorer were met during chapter 3."}),Object(x.jsx)("li",{children:"The three unique Trades (New Givini, Tak'Kan and Chalice States) were bought at the end of chapter 3."}),Object(x.jsx)("li",{children:"Chapter 3 in general was good enough for Yhilin to reach its final state during the first investment phase of Chapter 4."}),Object(x.jsx)("li",{children:"Chapter 3 in general and the war in particular were good enough for all petitions favorable to Givini to appear."}),Object(x.jsx)("li",{children:"All such petitions were approved."}),Object(x.jsx)("li",{children:"If purcharsed, the Givini Orc Merchant is bought before any other investment of the round."})]})]}),type:"info",showIcon:!0})]})},$=n(251),ee=n(250),te=n(244),ne=function(e){var t=e.combinationsCount,n=e.progress,r=e.investmentsCount,i=e.preprogress;return r?Object(x.jsxs)($.a,{visible:!0,centered:!0,closable:!1,footer:null,children:[Object(x.jsxs)("div",{children:[Object(x.jsxs)("p",{children:["Prefiltering ".concat(Math.pow(2,r).toLocaleString("en-US")," (2"),Object(x.jsx)("sup",{children:r}),") possibilities\u2026"]}),Object(x.jsx)(ee.a,{percent:Math.round(100*i)})]}),!!t&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(te.a,{}),Object(x.jsxs)("div",{children:[Object(x.jsx)("p",{children:"Processing ".concat(t.toLocaleString("en-US")," remaining possibilities\u2026")}),Object(x.jsx)(ee.a,{percent:Math.round(1e4*n)/100})]})]})]}):null},re=function(){var e=Object(r.useState)(),t=Object(c.a)(e,2),n=t[0],i=t[1],a=Object(r.useState)(!1),s=Object(c.a)(a,2),o=s[0],d=s[1],h=Object(r.useState)(),j=Object(c.a)(h,2),b=j[0],m=j[1],v=Object(r.useState)(0),p=Object(c.a)(v,2),f=p[0],g=p[1],O=Object(r.useState)(),S=Object(c.a)(O,2),y=S[0],w=S[1],I=Object(r.useState)(0),k=Object(c.a)(I,2),C=k[0],P=k[1];if(Object(r.useEffect)((function(){return n||i(H()()),function(){null===n||void 0===n||n.terminate()}}),[n]),!n)return null;var T=function(e){var t=e.workerInstance,n=e.setLoading,r=e.setCombinationsCount,i=e.setProgress,a=e.setInvestmentsCount,s=e.setPreprogress;return function(){var e=Object(u.a)(l.a.mark((function e(c){var o,u,d,h,j,b,m;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(!0),e.next=3,t.prepare(c);case 3:o=e.sent,a(o),s(0),u=0,d=0;case 8:if(!(d<=o)){e.next=17;break}return e.t0=u,e.next=12,t.preprocess();case 12:u=e.t0+=e.sent,s(d/o);case 14:d++,e.next=8;break;case 17:r(u),i(0),h=1e4,b=0;case 21:if(!(b<Math.ceil(u/h))){e.next=30;break}return m=Math.min((b+1)*h,u),e.next=25,t.process(b*h,m);case 25:j=e.sent,i(m/u);case 27:b++,e.next=21;break;case 30:return e.next=32,t.clean();case 32:return n(!1),r(void 0),a(void 0),i(0),s(0),e.abrupt("return",j);case 38:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}({workerInstance:n,setLoading:d,setCombinationsCount:m,setProgress:g,setInvestmentsCount:w,setPreprogress:P});return Object(x.jsxs)("div",{children:[Object(x.jsx)(Z,{}),Object(x.jsx)(U,{runInWoker:T,loading:o}),o&&Object(x.jsx)(ne,{combinationsCount:b,progress:f,preprogress:C,investmentsCount:y})]})},ie=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,254)).then((function(t){var n=t.getCLS,r=t.getFID,i=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),r(e),i(e),a(e),s(e)}))};s.a.render(Object(x.jsx)(i.a.StrictMode,{children:Object(x.jsx)(re,{})}),document.getElementById("root")),ie()}},[[242,1,2]]]);
//# sourceMappingURL=main.f4a14690.chunk.js.map